# ✅ 部署前检查清单

## 📋 部署前准备

### 代码检查
- [ ] 所有功能测试通过
- [ ] AI助手创建日程功能正常
- [ ] WebSocket实时协作功能正常
- [ ] 通知系统工作正常
- [ ] 文件上传功能正常
- [ ] 数据报表显示正常
- [ ] 移动端适配良好

### 安全配置
- [ ] 修改默认管理员密码
- [ ] 生成强JWT密钥（至少32位）
- [ ] 配置生产环境API密钥
- [ ] 删除测试账号和数据
- [ ] 检查敏感信息是否泄露

### 环境变量
```bash
✅ NODE_ENV=production
✅ JWT_SECRET=强随机密钥（非默认值）
✅ DEEPSEEK_API_KEY=有效的API密钥
✅ ALLOWED_ORIGINS=允许的域名列表
✅ PORT=3000
```

### 数据备份
- [ ] 备份当前数据库文件
- [ ] 备份上传的文件
- [ ] 备份配置文件
- [ ] 导出测试数据（如需要）

---

## 🚀 部署过程检查

### 服务器准备
- [ ] 服务器已购买并可访问
- [ ] 获取服务器IP地址
- [ ] SSH连接正常
- [ ] 系统版本正确（Ubuntu 22.04推荐）
- [ ] 磁盘空间充足（至少20GB可用）

### 软件安装
- [ ] Node.js 18.x 安装成功
- [ ] NPM 版本正常
- [ ] Nginx 安装成功
- [ ] PM2 全局安装
- [ ] Git 安装（如使用版本控制）

### 项目部署
- [ ] 代码上传到服务器
- [ ] 依赖安装完成（npm install）
- [ ] 环境变量配置正确
- [ ] 数据目录创建
- [ ] 上传目录创建
- [ ] 文件权限设置正确

### 服务配置
- [ ] PM2启动应用成功
- [ ] PM2设置开机自启
- [ ] Nginx配置文件正确
- [ ] Nginx反向代理配置
- [ ] WebSocket代理配置
- [ ] 静态文件路径正确

### 网络配置
- [ ] 防火墙规则配置
- [ ] 端口开放（80, 443）
- [ ] DNS解析配置（如有域名）
- [ ] HTTPS证书配置（如需要）

---

## ✅ 部署后验证

### 基础功能测试
- [ ] 访问首页正常
- [ ] 登录功能正常
- [ ] 日历显示正常
- [ ] 创建工单功能
- [ ] 编辑工单功能
- [ ] 删除工单功能

### 高级功能测试
- [ ] AI助手窗口打开
- [ ] AI助手创建日程成功
- [ ] WebSocket连接成功
- [ ] 实时协作功能正常
- [ ] 通知推送正常
- [ ] 文件上传成功
- [ ] 报表生成正常

### 性能测试
- [ ] 页面加载时间 < 3秒
- [ ] API响应时间 < 500ms
- [ ] WebSocket延迟 < 100ms
- [ ] 大量数据加载正常
- [ ] 并发访问测试通过

### 安全测试
- [ ] HTTPS证书有效
- [ ] 默认密码已修改
- [ ] SQL注入防护
- [ ] XSS攻击防护
- [ ] CSRF防护
- [ ] 文件上传安全检查

### 浏览器兼容性
- [ ] Chrome/Edge 正常
- [ ] Firefox 正常
- [ ] Safari 正常（如需要）
- [ ] 移动端浏览器正常

---

## 🔧 运维配置检查

### 监控设置
- [ ] PM2监控配置
- [ ] 日志轮转设置
- [ ] 错误日志监控
- [ ] 性能监控工具

### 备份策略
- [ ] 自动备份脚本配置
- [ ] 备份时间设置（建议每日凌晨）
- [ ] 备份保留策略（建议7天）
- [ ] 远程备份配置（如需要）

### 更新机制
- [ ] 代码更新流程文档
- [ ] 数据库迁移脚本
- [ ] 回滚方案准备

---

## 📱 用户准备

### 文档准备
- [ ] 用户使用手册
- [ ] 管理员操作指南
- [ ] 常见问题FAQ
- [ ] 联系方式和技术支持

### 培训准备
- [ ] 管理员培训完成
- [ ] 用户培训安排
- [ ] 演示环境准备

### 通知用户
- [ ] 系统上线通知
- [ ] 访问地址告知
- [ ] 账号密码分发
- [ ] 使用教程发送

---

## 🎯 上线检查清单

### 上线前1天
- [ ] 所有测试通过
- [ ] 备份当前数据
- [ ] 准备回滚方案
- [ ] 通知用户上线时间

### 上线当天
- [ ] 系统维护公告
- [ ] 执行部署步骤
- [ ] 验证所有功能
- [ ] 监控系统状态

### 上线后1小时
- [ ] 检查错误日志
- [ ] 监控性能指标
- [ ] 收集用户反馈
- [ ] 处理紧急问题

### 上线后1天
- [ ] 全面功能测试
- [ ] 性能数据分析
- [ ] 用户反馈整理
- [ ] 问题修复计划

### 上线后1周
- [ ] 稳定性评估
- [ ] 性能优化
- [ ] 用户满意度调查
- [ ] 功能改进计划

---

## 🆘 应急预案

### 常见问题快速修复

#### 问题1：服务无法访问
```bash
# 检查服务状态
pm2 status
systemctl status nginx

# 重启服务
pm2 restart calendar
systemctl restart nginx
```

#### 问题2：数据库错误
```bash
# 停止服务
pm2 stop calendar

# 恢复备份
cd /var/www/xiezuoCalendar/backend
rm -rf data
tar -xzf /backup/data_latest.tar.gz

# 重启服务
pm2 restart calendar
```

#### 问题3：性能问题
```bash
# 检查资源使用
htop
pm2 monit

# 重启服务释放内存
pm2 restart calendar
```

### 紧急联系人
```
系统管理员: [姓名] - [电话] - [邮箱]
技术支持: [姓名] - [电话] - [邮箱]
服务器提供商: [电话] - [工单系统]
```

---

## 📊 关键指标

### 性能指标（建议值）
- 页面加载时间: < 3秒
- API响应时间: < 500ms
- WebSocket延迟: < 100ms
- 并发用户数: > 50
- 系统正常运行时间: > 99.5%

### 资源使用（参考值）
- CPU使用率: < 70%
- 内存使用率: < 80%
- 磁盘使用率: < 80%
- 网络带宽: 根据用户数调整

---

## 📝 部署记录表

```
部署日期: _______________
部署人员: _______________
服务器IP: _______________
域名地址: _______________
数据库版本: _____________
代码版本: _______________

功能测试: □ 通过  □ 未通过
性能测试: □ 通过  □ 未通过
安全测试: □ 通过  □ 未通过

备注: 
_______________________________
_______________________________
_______________________________

签字确认: _______________
```

---

## 🎓 最佳实践

### 部署建议
1. ✅ 先在测试环境验证
2. ✅ 选择低峰期部署
3. ✅ 准备完整的回滚方案
4. ✅ 保持与用户的沟通
5. ✅ 持续监控系统状态

### 安全建议
1. 🔒 使用HTTPS
2. 🔒 定期更新系统
3. 🔒 强密码策略
4. 🔒 定期备份数据
5. 🔒 最小权限原则

### 性能建议
1. ⚡ 启用Gzip压缩
2. ⚡ 使用CDN加速
3. ⚡ 配置Redis缓存
4. ⚡ 数据库索引优化
5. ⚡ 定期清理日志

---

## ✨ 成功标准

部署成功的标志：
- ✅ 所有用户可正常访问
- ✅ 所有功能工作正常
- ✅ 性能指标达标
- ✅ 无严重错误日志
- ✅ 用户反馈良好

---

**祝您部署顺利！**

如有问题，请参考：
- 📖 `部署指南.md` - 详细技术文档
- ⚡ `快速部署.md` - 快速上手指南
- 🧪 `测试指南.md` - 功能测试方法
